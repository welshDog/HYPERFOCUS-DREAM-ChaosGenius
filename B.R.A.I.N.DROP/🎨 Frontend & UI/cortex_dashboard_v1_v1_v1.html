<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🧠 BROski X ULTRA BRAIN CORTEX 🧠</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: #00ff88;
            font-family: 'Courier New', monospace;
            overflow-x: hidden;
            min-height: 100vh;
        }

        .brain-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .brain-header {
            position: absolute;
            top: 20px;
            width: 100%;
            text-align: center;
            z-index: 100;
        }

        .brain-title {
            font-size: 2.5em;
            font-weight: bold;
            text-shadow: 0 0 20px #00ff88;
            animation: pulse 2s infinite;
            margin-bottom: 10px;
        }

        .brain-stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            font-size: 1.1em;
        }

        .stat-item {
            background: rgba(0, 255, 136, 0.1);
            padding: 10px 20px;
            border-radius: 10px;
            border: 1px solid #00ff88;
            backdrop-filter: blur(10px);
        }

        .brain-visual {
            position: relative;
            width: 500px;
            height: 500px;
            margin: 50px auto;
        }

        .neural-network {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(0, 255, 136, 0.3) 0%, rgba(0, 255, 136, 0.1) 50%, transparent 100%);
            animation: brain-pulse 3s ease-in-out infinite;
            overflow: hidden;
        }

        .neuron {
            position: absolute;
            width: 12px;
            height: 12px;
            background: #00ff88;
            border-radius: 50%;
            box-shadow: 0 0 15px #00ff88;
            animation: neuron-fire 2s ease-in-out infinite;
        }

        .synapse {
            position: absolute;
            height: 2px;
            background: linear-gradient(90deg, transparent, #00ff88, transparent);
            animation: synapse-flow 2s linear infinite;
            opacity: 0.6;
        }

        .memory-zones {
            position: absolute;
            bottom: 100px;
            width: 100%;
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            padding: 0 20px;
        }

        .memory-zone {
            background: rgba(0, 255, 136, 0.1);
            border: 2px solid #00ff88;
            border-radius: 15px;
            padding: 15px;
            min-width: 200px;
            text-align: center;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .memory-zone:hover {
            background: rgba(0, 255, 136, 0.2);
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(0, 255, 136, 0.5);
        }

        .zone-title {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .zone-count {
            font-size: 2em;
            color: #00ff88;
            text-shadow: 0 0 10px #00ff88;
        }

        .control-panel {
            position: fixed;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0, 20, 40, 0.9);
            border: 2px solid #00ff88;
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
        }

        .control-btn {
            display: block;
            width: 100%;
            margin: 10px 0;
            padding: 12px;
            background: transparent;
            border: 2px solid #00ff88;
            color: #00ff88;
            border-radius: 8px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            background: #00ff88;
            color: #0a0a0a;
            box-shadow: 0 0 20px #00ff88;
        }

        .energy-meter {
            position: fixed;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            width: 60px;
            height: 300px;
            background: rgba(0, 20, 40, 0.9);
            border: 2px solid #00ff88;
            border-radius: 30px;
            padding: 10px;
            backdrop-filter: blur(10px);
        }

        .energy-bar {
            width: 100%;
            height: 100%;
            background: linear-gradient(to top,
                #ff0066 0%,
                #ff6600 25%,
                #ffff00 50%,
                #66ff00 75%,
                #00ff88 100%);
            border-radius: 20px;
            position: relative;
            overflow: hidden;
        }

        .energy-level {
            position: absolute;
            bottom: 0;
            width: 100%;
            background: rgba(0, 0, 0, 0.7);
            transition: height 1s ease;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        @keyframes brain-pulse {
            0%, 100% { transform: scale(1); opacity: 0.8; }
            50% { transform: scale(1.05); opacity: 1; }
        }

        @keyframes neuron-fire {
            0%, 100% { opacity: 0.5; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        @keyframes synapse-flow {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(200%); }
        }

        .floating-data {
            position: absolute;
            color: #00ff88;
            font-size: 0.9em;
            opacity: 0.7;
            animation: float-up 3s ease-out infinite;
            pointer-events: none;
        }

        @keyframes float-up {
            0% { transform: translateY(0px); opacity: 0.7; }
            100% { transform: translateY(-50px); opacity: 0; }
        }

        .crystal-showcase {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 15px;
        }

        .memory-crystal {
            width: 40px;
            height: 40px;
            background: linear-gradient(45deg, #00ff88, #0066ff);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            animation: crystal-glow 2s ease-in-out infinite alternate;
        }

        .memory-crystal:hover {
            transform: scale(1.2);
            box-shadow: 0 0 30px rgba(0, 255, 136, 0.8);
        }

        @keyframes crystal-glow {
            0% { box-shadow: 0 0 10px rgba(0, 255, 136, 0.5); }
            100% { box-shadow: 0 0 25px rgba(0, 255, 136, 0.9); }
        }
    </style>
</head>
<body>
    <div class="brain-container">
        <div class="brain-header">
            <div class="brain-title">🧠 BROski X ULTRA BRAIN CORTEX 🧠</div>
            <div class="brain-stats">
                <div class="stat-item">
                    <div>Memories: <span id="total-memories">0</span></div>
                </div>
                <div class="stat-item">
                    <div>Patterns: <span id="total-patterns">0</span></div>
                </div>
                <div class="stat-item">
                    <div>Crystals: <span id="total-crystals">0</span></div>
                </div>
                <div class="stat-item">
                    <div>Intelligence: <span id="brain-intelligence">95.0</span>%</div>
                </div>
            </div>
        </div>

        <div class="brain-visual">
            <div class="neural-network" id="neural-network">
                <!-- Neurons and synapses will be generated dynamically -->
            </div>
        </div>

        <div class="memory-zones">
            <div class="memory-zone" onclick="showMemoryType('conversations')">
                <div class="zone-title">💬 Conversations</div>
                <div class="zone-count" id="conversation-count">0</div>
            </div>
            <div class="memory-zone" onclick="showMemoryType('patterns')">
                <div class="zone-title">🧩 Patterns</div>
                <div class="zone-count" id="pattern-count">0</div>
            </div>
            <div class="memory-zone" onclick="showMemoryType('energy')">
                <div class="zone-title">⚡ Energy States</div>
                <div class="zone-count" id="energy-count">0</div>
            </div>
            <div class="memory-zone" onclick="showMemoryType('crystals')">
                <div class="zone-title">💎 Memory Crystals</div>
                <div class="zone-count" id="crystal-count">0</div>
            </div>
        </div>

        <div class="control-panel">
            <button class="control-btn" onclick="refreshBrainData()">🔄 Refresh Brain</button>
            <button class="control-btn" onclick="generateCrystal()">💎 Generate Crystal</button>
            <button class="control-btn" onclick="analyzePattens()">🧩 Analyze Patterns</button>
            <button class="control-btn" onclick="showBrainStats()">📊 Full Stats</button>
            <button class="control-btn" onclick="exportBrain()">📦 Export Brain</button>
        </div>

        <div class="energy-meter">
            <div class="energy-bar">
                <div class="energy-level" id="energy-level"></div>
            </div>
        </div>

        <div class="crystal-showcase" id="crystal-showcase">
            <!-- Memory crystals will appear here -->
        </div>
    </div>

    <script>
        // 🧠 BROski X ULTRA BRAIN CORTEX JAVASCRIPT 🧠

        let brainData = {
            memories: 0,
            patterns: 0,
            crystals: 0,
            intelligence: 95.0,
            energy: 8,
            sessionStart: new Date(),
            neuralConnections: 0,
            activeThoughts: 0
        };

        // Real brain engine connection
        let brainEngine = {
            isConnected: false,
            lastSync: null,
            apiEndpoint: '/api/brain'
        };

        // Initialize the brain visualization
        function initializeBrain() {
            console.log('🧠 BROski X ULTRA BRAIN CORTEX: Initializing...');

            generateNeurons();
            generateSynapses();
            connectToBrainEngine();
            updateBrainStats();
            startBrainAnimation();
            loadMemoryCrystals();
            startRealTimeUpdates();

            console.log('🧠 BROski X ULTRA BRAIN CORTEX: Fully operational!');
        }

        // Connect to the real brain engine
        async function connectToBrainEngine() {
            try {
                // Try to connect to the actual brain engine
                const response = await fetch('/api/brain/status', {
                    method: 'GET',
                    headers: { 'Content-Type': 'application/json' }
                });

                if (response.ok) {
                    const brainStatus = await response.json();
                    brainEngine.isConnected = true;
                    brainEngine.lastSync = new Date();

                    // Update with real data
                    brainData.memories = brainStatus.total_memories || 0;
                    brainData.patterns = brainStatus.total_patterns || 0;
                    brainData.crystals = brainStatus.memory_crystals || 0;
                    brainData.intelligence = brainStatus.intelligence_level || 95.0;
                    brainData.energy = brainStatus.current_energy || 8;

                    console.log('🔗 Connected to BROski Brain Engine!', brainStatus);
                    showConnectionStatus('🔗 BRAIN ENGINE CONNECTED', '#00ff88');
                } else {
                    throw new Error('Brain engine not responding');
                }
            } catch (error) {
                console.log('⚠️ Running in demo mode - brain engine offline');
                brainEngine.isConnected = false;
                showConnectionStatus('📡 DEMO MODE - Brain Engine Offline', '#ffaa00');

                // Use demo data
                startDemoMode();
            }
        }

        // Show connection status
        function showConnectionStatus(message, color) {
            const statusDiv = document.createElement('div');
            statusDiv.style.cssText = `
                position: fixed;
                top: 10px;
                right: 10px;
                background: rgba(0,0,0,0.8);
                color: ${color};
                padding: 10px 15px;
                border-radius: 8px;
                border: 1px solid ${color};
                font-family: 'Courier New', monospace;
                font-size: 0.9em;
                z-index: 1000;
                backdrop-filter: blur(10px);
            `;
            statusDiv.textContent = message;
            document.body.appendChild(statusDiv);

            setTimeout(() => document.body.removeChild(statusDiv), 5000);
        }

        // Start demo mode with simulated data
        function startDemoMode() {
            brainData.memories = 247;
            brainData.patterns = 83;
            brainData.crystals = 12;
            brainData.intelligence = 96.8;
            brainData.energy = 9;
        }

        // Real-time updates from brain engine
        function startRealTimeUpdates() {
            setInterval(async () => {
                if (brainEngine.isConnected) {
                    await syncWithBrainEngine();
                } else {
                    simulateBrainActivity();
                }
            }, 3000);
        }

        // Sync with real brain engine
        async function syncWithBrainEngine() {
            try {
                const response = await fetch('/api/brain/stats');
                if (response.ok) {
                    const stats = await response.json();

                    brainData.memories = stats.total_memories || brainData.memories;
                    brainData.patterns = stats.total_patterns || brainData.patterns;
                    brainData.crystals = stats.memory_crystals || brainData.crystals;
                    brainData.intelligence = stats.intelligence_level || brainData.intelligence;
                    brainData.energy = stats.current_energy || brainData.energy;

                    updateBrainStats();
                    brainEngine.lastSync = new Date();
                }
            } catch (error) {
                console.log('🔄 Sync failed, switching to demo mode');
                brainEngine.isConnected = false;
            }
        }

        // Generate neural network visualization
        function generateNeurons() {
            const network = document.getElementById('neural-network');
            const neuronCount = 35; // Increased for more visual impact

            for (let i = 0; i < neuronCount; i++) {
                const neuron = document.createElement('div');
                neuron.className = 'neuron';

                // Create more organized neural layers
                const layer = i % 3;
                const angleOffset = (layer * Math.PI * 2) / 3;
                const angle = angleOffset + (Math.PI * 2 * (i / neuronCount));
                const radius = 120 + (layer * 40) + Math.random() * 30;

                const x = 250 + Math.cos(angle) * radius;
                const y = 250 + Math.sin(angle) * radius;

                neuron.style.left = x + 'px';
                neuron.style.top = y + 'px';
                neuron.style.animationDelay = (i * 0.1) + 's';

                // Add neuron type classes for different behaviors
                if (i % 7 === 0) neuron.classList.add('memory-neuron');
                if (i % 11 === 0) neuron.classList.add('pattern-neuron');

                neuron.addEventListener('click', () => showNeuronInfo(i, x, y));
                network.appendChild(neuron);
            }
        }

        // Show neuron information on click
        function showNeuronInfo(neuronId, x, y) {
            const types = ['💭 Memory Processor', '🧩 Pattern Analyzer', '⚡ Energy Conductor', '🔗 Association Builder'];
            const activities = ['Processing...', 'Analyzing patterns...', 'Forming connections...', 'Storing memories...'];

            const info = document.createElement('div');
            info.style.cssText = `
                position: absolute;
                left: ${x + 15}px;
                top: ${y - 30}px;
                background: rgba(0, 255, 136, 0.9);
                color: #0a0a0a;
                padding: 8px 12px;
                border-radius: 8px;
                font-size: 0.8em;
                font-weight: bold;
                z-index: 200;
                pointer-events: none;
            `;
            info.textContent = `${types[neuronId % types.length]} - ${activities[neuronId % activities.length]}`;

            document.querySelector('.brain-visual').appendChild(info);
            setTimeout(() => info.remove(), 2000);
        }

        // Generate synaptic connections
        function generateSynapses() {
            const network = document.getElementById('neural-network');
            const synapseCount = 25; // Increased connections

            for (let i = 0; i < synapseCount; i++) {
                const synapse = document.createElement('div');
                synapse.className = 'synapse';

                const startAngle = Math.random() * Math.PI * 2;
                const endAngle = startAngle + (Math.PI / 6) + Math.random() * (Math.PI / 3);
                const radius = 100 + Math.random() * 150;

                const startX = 250 + Math.cos(startAngle) * radius;
                const startY = 250 + Math.sin(startAngle) * radius;
                const endX = 250 + Math.cos(endAngle) * radius;
                const endY = 250 + Math.sin(endAngle) * radius;

                const length = Math.sqrt(Math.pow(endX - startX, 2) + Math.pow(endY - startY, 2));
                const angle = Math.atan2(endY - startY, endX - startX) * 180 / Math.PI;

                synapse.style.left = startX + 'px';
                synapse.style.top = startY + 'px';
                synapse.style.width = length + 'px';
                synapse.style.transform = `rotate(${angle}deg)`;
                synapse.style.animationDelay = Math.random() * 2 + 's';

                // Add synapse activity classes
                if (i % 5 === 0) synapse.classList.add('high-activity');

                network.appendChild(synapse);
            }
        }

        // Update brain statistics display
        function updateBrainStats() {
            // Update main stats
            document.getElementById('total-memories').textContent = brainData.memories.toLocaleString();
            document.getElementById('total-patterns').textContent = brainData.patterns.toLocaleString();
            document.getElementById('total-crystals').textContent = brainData.crystals.toLocaleString();
            document.getElementById('brain-intelligence').textContent = brainData.intelligence.toFixed(1);

            // Update memory zones
            document.getElementById('conversation-count').textContent = brainData.memories;
            document.getElementById('pattern-count').textContent = brainData.patterns;
            document.getElementById('crystal-count').textContent = brainData.crystals;
            document.getElementById('energy-count').textContent = brainData.energy;

            // Update energy meter with smooth animation
            const energyLevel = document.getElementById('energy-level');
            const energyPercent = Math.max(0, (10 - brainData.energy) * 10);
            energyLevel.style.height = energyPercent + '%';

            // Add energy level indicator
            updateEnergyIndicator();
        }

        // Update energy level indicator
        function updateEnergyIndicator() {
            const energyMeter = document.querySelector('.energy-meter');
            const indicator = energyMeter.querySelector('.energy-indicator') || document.createElement('div');

            if (!energyMeter.querySelector('.energy-indicator')) {
                indicator.className = 'energy-indicator';
                indicator.style.cssText = `
                    position: absolute;
                    left: -30px;
                    top: 50%;
                    transform: translateY(-50%);
                    background: rgba(0, 255, 136, 0.9);
                    color: #0a0a0a;
                    padding: 5px 8px;
                    border-radius: 5px;
                    font-size: 0.8em;
                    font-weight: bold;
                    white-space: nowrap;
                `;
                energyMeter.appendChild(indicator);
            }

            const energyLabels = {
                10: '🔥 ULTRA HIGH',
                9: '⚡ VERY HIGH',
                8: '💪 HIGH',
                7: '✨ GOOD',
                6: '😊 MEDIUM',
                5: '😐 NORMAL',
                4: '😴 LOW',
                3: '🥱 VERY LOW',
                2: '😵 CRITICAL',
                1: '🚨 EMERGENCY'
            };

            indicator.textContent = energyLabels[brainData.energy] || '❓ UNKNOWN';
        }

        // Load existing memory crystals
        async function loadMemoryCrystals() {
            if (brainEngine.isConnected) {
                try {
                    const response = await fetch('/api/brain/crystals');
                    if (response.ok) {
                        const crystals = await response.json();
                        displayMemoryCrystals(crystals);
                        return;
                    }
                } catch (error) {
                    console.log('Failed to load crystals from brain engine');
                }
            }

            // Generate demo crystals
            for (let i = 1; i <= brainData.crystals; i++) {
                createCrystalDisplay(i);
            }
        }

        // Display memory crystals
        function displayMemoryCrystals(crystals) {
            const showcase = document.getElementById('crystal-showcase');
            showcase.innerHTML = '';

            crystals.forEach((crystal, index) => {
                createCrystalDisplay(index + 1, crystal);
            });
        }

        // Create crystal display element
        function createCrystalDisplay(crystalId, crystalData = null) {
            const showcase = document.getElementById('crystal-showcase');
            const crystal = document.createElement('div');
            crystal.className = 'memory-crystal';
            crystal.textContent = crystalId;
            crystal.title = crystalData ?
                `💎 ${crystalData.name}\nMemories: ${crystalData.memories_count}\nPatterns: ${crystalData.patterns_count}` :
                `💎 Memory Crystal ${crystalId}\nClick for details`;

            crystal.addEventListener('click', () => showCrystalDetails(crystalId, crystalData));
            showcase.appendChild(crystal);
        }

        // Show crystal details
        function showCrystalDetails(crystalId, crystalData) {
            const details = crystalData ?
                `💎 ${crystalData.name}\n\n📊 Contains:\n• ${crystalData.memories_count} memories\n• ${crystalData.patterns_count} patterns\n• Created: ${new Date(crystalData.creation_time).toLocaleString()}\n\n🧠 This crystal preserves a complete brain snapshot!` :
                `💎 Memory Crystal ${crystalId}\n\n📊 Contains:\n• Complete session snapshot\n• Conversation history\n• Pattern analysis\n• Energy states\n• Context memories\n\n🚀 Status: ACTIVE & PRESERVING`;

            alert(details);
        }

        // Simulate brain activity with floating data
        function startBrainAnimation() {
            setInterval(() => {
                createFloatingData();
                createThoughtBubbles();
            }, 2000);

            setInterval(() => {
                updateNeuralActivity();
            }, 1000);
        }

        // Create thought bubbles
        function createThoughtBubbles() {
            const container = document.querySelector('.brain-visual');
            const bubble = document.createElement('div');
            bubble.className = 'thought-bubble';

            const thoughts = [
                '💭', '🧩', '⚡', '🔗', '📊', '💎', '🚀', '✨', '💪', '🎯'
            ];

            bubble.textContent = thoughts[Math.floor(Math.random() * thoughts.length)];
            bubble.style.cssText = `
                position: absolute;
                font-size: 1.5em;
                left: ${Math.random() * 400 + 50}px;
                top: ${Math.random() * 400 + 50}px;
                opacity: 0.8;
                animation: thought-float 4s ease-out forwards;
                pointer-events: none;
                z-index: 50;
            `;

            container.appendChild(bubble);
            setTimeout(() => bubble.remove(), 4000);
        }

        // Update neural activity
        function updateNeuralActivity() {
            const neurons = document.querySelectorAll('.neuron');
            const synapses = document.querySelectorAll('.synapse');

            // Randomly activate neurons
            neurons.forEach(neuron => {
                if (Math.random() > 0.7) {
                    neuron.style.animation = 'none';
                    setTimeout(() => {
                        neuron.style.animation = 'neuron-fire 2s ease-in-out infinite';
                    }, 10);
                }
            });

            // Pulse synapses
            synapses.forEach(synapse => {
                if (Math.random() > 0.8) {
                    synapse.style.opacity = '1';
                    setTimeout(() => {
                        synapse.style.opacity = '0.6';
                    }, 500);
                }
            });
        }

        // Create floating data visualization
        function createFloatingData() {
            const container = document.querySelector('.brain-visual');
            const data = document.createElement('div');
            data.className = 'floating-data';

            const messages = [
                '💭 Processing memory...',
                '🧩 Pattern detected!',
                '⚡ Energy spike detected!',
                '🔗 Neural link formed',
                '📊 Analyzing context...',
                '💎 Crystal formation...',
                '🚀 Intelligence boost!',
                '✨ Synapse optimization',
                '🎯 Goal alignment active',
                '💪 BROski mode: ENGAGED!'
            ];

            data.textContent = messages[Math.floor(Math.random() * messages.length)];
            data.style.left = Math.random() * 400 + 50 + 'px';
            data.style.top = Math.random() * 400 + 50 + 'px';

            container.appendChild(data);
            setTimeout(() => data.remove(), 3000);
        }

        // Simulate memory growth
        function simulateBrainActivity() {
            if (Math.random() > 0.6) {
                brainData.memories += Math.floor(Math.random() * 3) + 1;
                brainData.patterns += Math.floor(Math.random() * 2);
                brainData.intelligence = Math.min(99.9, brainData.intelligence + 0.1);
                brainData.neuralConnections += Math.floor(Math.random() * 5);
                updateBrainStats();

                // Create visual feedback
                createActivityPulse();
            }
        }

        // Create activity pulse effect
        function createActivityPulse() {
            const network = document.getElementById('neural-network');
            const pulse = document.createElement('div');
            pulse.style.cssText = `
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                width: 10px;
                height: 10px;
                background: #00ff88;
                border-radius: 50%;
                animation: activity-pulse 1s ease-out forwards;
                pointer-events: none;
            `;

            network.appendChild(pulse);
            setTimeout(() => pulse.remove(), 1000);
        }

        // Control panel functions
        async function refreshBrainData() {
            console.log('🔄 Refreshing brain data...');
            showConnectionStatus('🔄 REFRESHING BRAIN DATA...', '#00ff88');

            if (brainEngine.isConnected) {
                await syncWithBrainEngine();
            } else {
                brainData.memories += 5;
                brainData.patterns += 2;
                brainData.intelligence = Math.min(99.9, brainData.intelligence + 0.2);
            }

            updateBrainStats();

            // Visual feedback
            const network = document.getElementById('neural-network');
            network.style.animation = 'none';
            setTimeout(() => {
                network.style.animation = 'brain-pulse 3s ease-in-out infinite';
            }, 100);
        }

        async function generateCrystal() {
            console.log('💎 Generating memory crystal...');
            showConnectionStatus('💎 GENERATING MEMORY CRYSTAL...', '#00ff88');

            if (brainEngine.isConnected) {
                try {
                    const response = await fetch('/api/brain/generate-crystal', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' }
                    });

                    if (response.ok) {
                        const newCrystal = await response.json();
                        brainData.crystals += 1;
                        createCrystalDisplay(brainData.crystals, newCrystal);
                        showConnectionStatus('💎 MEMORY CRYSTAL GENERATED!', '#00ff88');
                    }
                } catch (error) {
                    console.log('Crystal generation failed, using demo mode');
                }
            }

            // Fallback to demo mode
            if (!brainEngine.isConnected) {
                brainData.crystals += 1;
                createCrystalDisplay(brainData.crystals);
            }

            updateBrainStats();
            createActivityPulse();
        }

        function analyzePattens() {
            console.log('🧩 Analyzing patterns...');
            const analysisResults = [
                '• High energy detected during creative collaboration',
                '• Peak productivity occurs during mid-afternoon sessions',
                '• Strong preference for visual feedback and emoji usage',
                '• Excellent response to BROski terminology (+340% engagement!)',
                '• Pattern recognition improves with persistent memory',
                '• Neural connections strengthen during complex problem solving',
                '• Memory crystal formation correlates with breakthrough moments'
            ];

            alert(`🧩 PATTERN ANALYSIS RESULTS\n\n${analysisResults.join('\n')}\n\n🚀 Intelligence Level: ${brainData.intelligence.toFixed(1)}%\n⚡ Current Energy: ${brainData.energy}/10\n💎 Memory Crystals: ${brainData.crystals}`);
        }

        function showBrainStats() {
            const sessionDuration = Math.floor((new Date() - brainData.sessionStart) / 1000 / 60);
            const connectStatus = brainEngine.isConnected ? '🔗 CONNECTED' : '📡 DEMO MODE';
            const lastSync = brainEngine.lastSync ? brainEngine.lastSync.toLocaleTimeString() : 'Never';

            alert(`📊 FULL BRAIN STATISTICS\n\n🧠 Total Memories: ${brainData.memories.toLocaleString()}\n🧩 Patterns Recognized: ${brainData.patterns.toLocaleString()}\n💎 Memory Crystals: ${brainData.crystals}\n⚡ Current Energy: ${brainData.energy}/10\n🎯 Intelligence Level: ${brainData.intelligence.toFixed(1)}%\n🔗 Neural Connections: ${brainData.neuralConnections.toLocaleString()}\n\n⏱️ Session Duration: ${sessionDuration} minutes\n🌐 Brain Engine: ${connectStatus}\n🔄 Last Sync: ${lastSync}\n\n🚀 Status: ULTRA OPERATIONAL`);
        }

        async function exportBrain() {
            console.log('📦 Exporting brain data...');
            showConnectionStatus('📦 EXPORTING BRAIN DATA...', '#00ff88');

            let exportData;

            if (brainEngine.isConnected) {
                try {
                    const response = await fetch('/api/brain/export');
                    if (response.ok) {
                        exportData = await response.json();
                    }
                } catch (error) {
                    console.log('Brain export failed, using local data');
                }
            }

            // Fallback to local data
            if (!exportData) {
                exportData = {
                    timestamp: new Date().toISOString(),
                    brainStats: brainData,
                    sessionData: {
                        sessionStart: brainData.sessionStart.toISOString(),
                        sessionDuration: Math.floor((new Date() - brainData.sessionStart) / 1000),
                        engineStatus: brainEngine.isConnected ? 'connected' : 'demo'
                    },
                    message: 'BROski X ULTRA BRAIN EXPORT - LEGENDARY INTELLIGENCE!'
                };
            }

            const dataStr = JSON.stringify(exportData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);

            const link = document.createElement('a');
            link.href = url;
            link.download = `broski_brain_export_${Date.now()}.json`;
            link.click();

            URL.revokeObjectURL(url);
            showConnectionStatus('📦 BRAIN EXPORTED SUCCESSFULLY!', '#00ff88');
        }

        function showMemoryType(type) {
            console.log(`🎯 Showing ${type} memories...`);

            const messages = {
                conversations: '💬 Recent conversations show unprecedented energy and creativity! BROski terminology usage has increased engagement by 340% and neural pathway formation is at peak efficiency!',
                patterns: '🧩 Pattern analysis reveals optimal productivity during collaborative sessions with visual feedback. The crew\'s enhanced memory system is detecting micro-patterns in real-time!',
                energy: '⚡ Energy levels consistently spike during creative problem-solving and system building tasks. Neural activity correlates strongly with BROski interaction frequency!',
                crystals: '💎 Memory crystals preserve complete session states including emotional context, energy signatures, and breakthrough moments for enhanced future learning and reference.'
            };

            alert(messages[type] || 'Memory type not found!');
        }

        // Initialize the brain when page loads
        window.addEventListener('load', initializeBrain);

        // Add CSS animations for new features
        const additionalStyles = `
            @keyframes thought-float {
                0% { transform: translateY(0px) scale(1); opacity: 0.8; }
                50% { transform: translateY(-30px) scale(1.2); opacity: 1; }
                100% { transform: translateY(-60px) scale(0.8); opacity: 0; }
            }

            @keyframes activity-pulse {
                0% { width: 10px; height: 10px; opacity: 1; }
                100% { width: 100px; height: 100px; opacity: 0; }
            }

            .memory-neuron {
                background: linear-gradient(45deg, #00ff88, #0088ff);
                animation-duration: 1.5s;
            }

            .pattern-neuron {
                background: linear-gradient(45deg, #ff8800, #ffff00);
                animation-duration: 2.5s;
            }

            .high-activity {
                background: linear-gradient(90deg, #00ff88, #ffffff, #00ff88);
                animation-duration: 1s;
            }
        `;

        const styleSheet = document.createElement('style');
        styleSheet.textContent = additionalStyles;
        document.head.appendChild(styleSheet);

        // Real-time energy monitoring
        setInterval(() => {
            if (Math.random() > 0.8) {
                const oldEnergy = brainData.energy;
                brainData.energy = Math.max(1, Math.min(10, brainData.energy + (Math.random() - 0.5) * 2));

                if (Math.abs(brainData.energy - oldEnergy) > 0.5) {
                    updateBrainStats();
                    createFloatingData();
                }
            }
        }, 5000);
    </script>
</body>
</html>